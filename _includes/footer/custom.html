<!-- start custom footer snippets -->

<a href="/sitemap/">Sitemap</a>

<!-- Support for MatJax -->
<script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>

<!-- Support for Plotly -->
<script defer src='https://cdnjs.cloudflare.com/ajax/libs/plotly.js/3.0.1/plotly.min.js'></script>

<!-- Support for Mermaid -->
<script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
    mermaid.initialize({startOnLoad:true, theme:'default'});
    await mermaid.run({querySelector:'code.language-mermaid'});
</script>

<!-- ======== 文字版访问量 + 阅读量（CountAPI） ======== -->
<div id="visit-box" style="text-align:center; margin-top:15px; font-size:0.9rem; color:#555;">
  Visitors: <span id="total-visits">Loading...</span>
  &nbsp;|&nbsp;
  Page views: <span id="page-views">Loading...</span>
</div>

<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function () {
  console.log("Visitor counter script started.");

  const totalSpan = document.getElementById("total-visits");
  const pageSpan  = document.getElementById("page-views");

  // 如果没找到 span，就直接返回（避免报错导致一直 Loading）
  if (!totalSpan || !pageSpan) {
    console.error("Counter spans not found in DOM.");
    return;
  }

  const base = "https://api.countapi.xyz";
  const namespace = "haowu1701_github_io";

  // ---- 1) 网站总访问量 ----
  fetch(base + "/hit/" + namespace + "/total")
    .then(function (res) { return res.json(); })
    .then(function (data) {
      console.log("Total visits data:", data);
      totalSpan.innerText = data && data.value !== undefined ? data.value : "N/A";
    })
    .catch(function (err) {
      console.error("Total visits error:", err);
      totalSpan.innerText = "N/A";
    });

  // ---- 2) 当前页面访问次数 ----
  var pageKey = encodeURIComponent(window.location.pathname || "home");
  fetch(base + "/hit/" + namespace + "/" + pageKey)
    .then(function (res) { return res.json(); })
    .then(function (data) {
      console.log("Page views data:", data);
      pageSpan.innerText = data && data.value !== undefined ? data.value : "N/A";
    })
    .catch(function (err) {
      console.error("Page views error:", err);
      pageSpan.innerText = "N/A";
    });
});
</script>



<!-- end custom footer snippets -->
